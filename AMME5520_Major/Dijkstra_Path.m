%% AMME5520 Advanced Systems
function [min_dist, shortest_path] = Dijkstra_Path(D,start,ending)
%% Init Variables
%*************** Starting and Ending Nodes for user to edit ***************
% start = 1;      %start
% ending = 2;     %end
% % distances between each node
% %D = [NaN,NaN,118.934247403411,92.6237800205256,NaN,106.954620713786,NaN;NaN,NaN,NaN,NaN,106.584435372121,69.0583295763258,40.4897754885081;118.934247403411,NaN,NaN,57.1112185406558,NaN,NaN,NaN;92.6237800205256,NaN,57.1112185406558,NaN,NaN,NaN,NaN;NaN,106.584435372121,NaN,NaN,NaN,173.555762390938,120.865347447525;106.954620713786,69.0583295763258,NaN,NaN,173.555762390938,NaN,60.9131199638206;NaN,40.4897754885081,NaN,NaN,120.865347447525,60.9131199638206,NaN];
% D = [NaN,NaN,69.5359018743224,58.7534052769991,NaN,NaN,52.3277376361255,NaN,NaN,NaN,NaN,NaN,93.9927054886139,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,20.8798201784312,NaN,NaN,NaN,NaN,NaN,38.1296021862354,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,101.097767661007,96.8663406988984,51.1612506025028,52.9728859686061,NaN,72.6266015430434,NaN,NaN,NaN,45.4394404044906,NaN,NaN,NaN,NaN,60.5419781915360,7.10365004996658,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,32.8866241467186,9.04533232841597,NaN,NaN,NaN,NaN,NaN,NaN,NaN,15.2795951606329,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;69.5359018743224,101.097767661007,NaN,29.4700852614480,140.741294928730,50.2016462936499,17.2108470414522,NaN,38.5269854744265,25.9336687823690,NaN,NaN,103.085120177669,62.7842406428034,NaN,NaN,NaN,NaN,19.8848192280437,NaN,23.5526136186224,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,12.8402142741882,NaN,NaN,NaN;58.7534052769991,96.8663406988984,29.4700852614480,NaN,127.490211088256,56.0431316148283,24.3813013174124,NaN,18.1269592981795,27.0275164454358,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.2134380364307,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,24.5669816559492,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,51.1612506025028,140.741294928730,127.490211088256,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,78.6113553854781,NaN,31.9938683655171,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,39.7177477667664,NaN,NaN,18.9149460003743,NaN,15.2795760424558,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,25.8455331970149,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,52.9728859686061,50.2016462936499,56.0431316148283,NaN,NaN,NaN,NaN,NaN,NaN,18.8479744341951,54.1028296299740,NaN,NaN,NaN,35.4206467082976,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,28.9637961014542,NaN,NaN,NaN,NaN,NaN,NaN,27.0138942477371,NaN,NaN;52.3277376361255,NaN,17.2108470414522,24.3813013174124,NaN,NaN,NaN,NaN,40.1624149898560,NaN,NaN,NaN,96.5963311621663,67.8372561178290,NaN,NaN,NaN,NaN,7.38414774538490,NaN,36.0809376084926,40.1837653050307,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,72.6266015430434,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,86.9628352866843,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,35.5653492640525,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,38.5269854744265,18.1269592981795,NaN,NaN,40.1624149898560,NaN,NaN,21.0835031919694,NaN,49.3455565291718,NaN,NaN,NaN,NaN,NaN,NaN,NaN,29.2351999242885,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,10.2490810013679,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,25.9336687823690,27.0275164454358,NaN,NaN,NaN,NaN,21.0835031919694,NaN,46.7942704114088,NaN,NaN,NaN,NaN,46.0397141691295,NaN,NaN,NaN,43.9205568864361,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,13.2976963774727,NaN,NaN,NaN,NaN,NaN,NaN,13.1594942356536,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,18.8479744341951,NaN,NaN,NaN,46.7942704114088,NaN,NaN,NaN,NaN,NaN,30.4820917545302,NaN,NaN,NaN,NaN,NaN,NaN,57.1692805908151,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,47.2645184453570,NaN,NaN,NaN,NaN,NaN,NaN,NaN,27.2974576833963,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,45.4394404044906,NaN,NaN,NaN,54.1028296299740,NaN,NaN,49.3455565291718,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,44.5972869498929,NaN,22.6033357486964,NaN,NaN,NaN,NaN,NaN,4.35702964375512,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,34.6083626258129,NaN,NaN,NaN,NaN,NaN,12.2361461640449,NaN,NaN,NaN,NaN,NaN,NaN;93.9927054886139,NaN,103.085120177669,NaN,NaN,NaN,96.5963311621663,NaN,NaN,NaN,NaN,NaN,NaN,64.3632642795636,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,52.9447523002693,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.6498379133912,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,24.8209536411126,NaN,NaN,NaN,NaN,NaN;NaN,NaN,62.7842406428034,NaN,NaN,NaN,67.8372561178290,NaN,NaN,NaN,NaN,NaN,64.3632642795636,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,13.8152972303951,33.7134957317403,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,27.0873335099334,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,78.6113553854781,NaN,NaN,86.9628352866843,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,46.8416031028590,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,39.3258829155486,NaN,36.8432230995007,NaN,NaN,NaN,NaN,25.9799238049738,NaN,NaN,28.1307525658266,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,35.4206467082976,NaN,NaN,NaN,46.0397141691295,30.4820917545302,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,39.0024080214725,NaN,32.5823425698682,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,61.2374879572393,NaN,NaN,NaN,NaN,NaN,NaN,NaN,7.37250832217316,NaN,NaN,NaN,NaN,NaN,NaN,11.8308607932017,NaN,NaN;NaN,60.5419781915360,NaN,NaN,31.9938683655171,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,46.8416031028590,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,10.3933881354853,NaN,29.2716023057109,33.7676898317625,NaN,41.3828825415797,NaN,NaN,NaN,NaN,25.2070725238937,NaN,NaN,NaN,NaN,8.65278844375239,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,7.10365004996658,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,44.5972869498929,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,48.1362363624669,NaN,NaN,NaN,NaN,5.44692785751386,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.3516961492146,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,19.8848192280437,17.2134380364307,NaN,NaN,7.38414774538490,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,42.3863131915095,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,23.3275965149707,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,29.2351999242885,43.9205568864361,NaN,22.6033357486964,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,23.1497890217156,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,46.7537927511752,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,23.5526136186224,NaN,NaN,NaN,36.0809376084926,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,39.0024080214725,NaN,NaN,NaN,NaN,NaN,NaN,53.8269805535452,54.9781146431433,46.6435492707449,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,18.5665764159399,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,18.7575660613719,NaN;20.8798201784312,NaN,NaN,NaN,NaN,NaN,40.1837653050307,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,42.3863131915095,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,29.7712020006813,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,57.1692805908151,NaN,NaN,NaN,NaN,32.5823425698682,NaN,NaN,NaN,NaN,53.8269805535452,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,52.9447523002693,13.8152972303951,NaN,NaN,NaN,NaN,NaN,NaN,54.9781146431433,NaN,NaN,NaN,33.5409915255438,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,43.0705140024454,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,33.7134957317403,NaN,NaN,NaN,NaN,NaN,NaN,46.6435492707449,NaN,NaN,33.5409915255438,NaN,NaN,NaN,52.3754667869315,NaN,NaN,NaN,NaN,NaN,NaN,29.0923619859864,29.4878291544339,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,27.9856230917758,12.8930571888534;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,4.35702964375512,NaN,NaN,NaN,NaN,NaN,48.1362363624669,NaN,23.1497890217156,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,30.4440658530484,NaN,NaN,NaN,NaN,NaN,8.78782772764082,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,39.7177477667664,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,39.3258829155486,NaN,10.3933881354853,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,31.2257370955693,NaN,NaN,NaN,NaN,33.3108312721936,NaN,NaN,15.0188355825008,NaN,NaN,NaN,NaN,18.9888175906318,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;38.1296021862354,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,29.7712020006813,NaN,NaN,52.3754667869315,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,34.3070619128486,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,36.8432230995007,NaN,29.2716023057109,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,31.2257370955693,NaN,NaN,NaN,NaN,NaN,NaN,11.8479808166766,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,15.6795619103163,NaN,NaN,13.4302735840151,NaN,NaN,NaN,NaN;NaN,32.8866241467186,NaN,NaN,18.9149460003743,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,33.7676898317625,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,38.8872604139093,33.8541764283698,NaN,NaN,NaN,NaN,NaN,NaN,18.0826253161989,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,9.04533232841597,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,5.44692785751386,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,38.8872604139093,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,15.2795760424558,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,41.3828825415797,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,33.8541764283698,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,35.5653492640525,NaN,NaN,47.2645184453570,NaN,NaN,NaN,NaN,61.2374879572393,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,25.9799238049738,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,33.3108312721936,NaN,11.8479808166766,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,26.3399126124340,NaN,NaN,24.9897095297910,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.6498379133912,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,43.0705140024454,29.0923619859864,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,18.4631757012887,NaN,NaN,NaN,NaN,16.2237491398230;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,27.0873335099334,NaN,NaN,NaN,NaN,NaN,NaN,18.5665764159399,NaN,NaN,NaN,29.4878291544339,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,7.18400142615744,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,28.1307525658266,NaN,25.2070725238937,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,15.0188355825008,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,34.6083626258129,NaN,NaN,NaN,NaN,NaN,NaN,NaN,46.7537927511752,NaN,NaN,NaN,NaN,NaN,30.4440658530484,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.9999758563188,NaN,NaN,NaN,NaN,NaN,NaN;NaN,15.2795951606329,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.3516961492146,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,18.0826253161989,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,24.5669816559492,NaN,NaN,NaN,NaN,10.2490810013679,13.2976963774727,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,28.9637961014542,NaN,NaN,NaN,NaN,27.2974576833963,NaN,NaN,NaN,NaN,7.37250832217316,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,4.84611325719569,NaN,NaN;NaN,NaN,NaN,NaN,25.8455331970149,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,8.65278844375239,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,18.9888175906318,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,35.1841278041769,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,15.6795619103163,NaN,NaN,NaN,NaN,26.3399126124340,NaN,NaN,NaN,NaN,NaN,NaN,NaN,35.1841278041769,NaN,NaN,NaN,4.79065477681834,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,12.2361461640449,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,8.78782772764082,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.9999758563188,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,24.8209536411126,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,34.3070619128486,NaN,NaN,NaN,NaN,NaN,NaN,18.4631757012887,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,29.4864166520227;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,13.4302735840151,NaN,NaN,NaN,NaN,24.9897095297910,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,4.79065477681834,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,12.8402142741882,NaN,NaN,NaN,NaN,NaN,NaN,13.1594942356536,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,23.3275965149707,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,27.0138942477371,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,11.8308607932017,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,4.84611325719569,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,18.7575660613719,NaN,NaN,NaN,27.9856230917758,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,7.18400142615744,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,12.8930571888534,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,16.2237491398230,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,29.4864166520227,NaN,NaN,NaN,NaN,NaN];
%**************************************************************************

% Get size of data
[size_D,cols] = size(D);

inf = 10e10;

% Initialise Q = Open Set, nodes to be visited
Q = ones(1,size_D);

% Initaialise S visited set
S = zeros(1,size_D);

% Initilise cost matrix V, store min cost to each node
V = ones(1,size_D)*inf;    %Min cost to each node
V(start) = 0;   %cost to starting node is 0

% Initialise Pi = source node
Pi = zeros(1,size_D);

%% Find Shortest Distances to Each Path
% loop as long as there are nodes to reach
while norm(Q) ~= 0
    
    % Select first X from Q
    for j=1:size_D
        if Q(j) ~= 0
            x = j;
            break
        end
    end
    % Move X from Q -> S
    Q(x) = 0;
    S(x) = 1;
    
    % Find number of paths from X
    paths = 0;  %number of path from x
    R = zeros(1);   %array to store path sources
    for j = 1:size_D
        %check if there is a path. Check along the rows
        if isnan(D(x,j)) ~= 1
            %if there is a path, store the node into R
            paths = paths + 1;
            R(paths) = j;
        end
    end
    
    if norm(R) > 0
        [rows,num_paths] = size(R);
        % Repeat for all y Paths from X
        for k = 1:num_paths
            y = R(k);   % y is the current neighbour we are looking at
            dist = V(x) + D(x,y);  % calc distance            
            %check if distance in this path is less than current path
            if dist < V(y)
                V(y) = dist; %update distance
                Pi(y) = x;    %update Pi
                Q(y) = 1;     %put Y into open set as a new shortest path found 
            end
        end % end for loop
    end % end norm(R) > 0
end   %end while loop

%% Find Shortest Path
i = 1;
found = 0;
Path = ending;
x = ending;
while found == 0
    i = i + 1;
    Path(i) = Pi(x);
    x = Pi(x);
    if x == start
        found = 1;
    end
end
Path = rot90(Path,2);
disp(['Shortest Path = ' num2str(Path)]);
disp(['Minimum Cost = ' num2str(V(ending))]);
min_dist = V(ending);
shortest_path = Path;

